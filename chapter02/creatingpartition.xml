<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-partitioning-creatingpartition">
  <?dbhtml filename="creatingpartition.html"?>

  <title>Создание нового раздела</title>

  <para>Как и большинство других операционных систем, LFS обычно устанавливается на
  отдельный раздел. Рекомендуемый подход к созданию системы LFS заключается в использовании
  существующего пустого раздела. Вы можете создать новый раздел, если у вас есть
  неразмеченное пространство на диске.</para>

  <para>Минимальная установка требует раздел  10 гигабайт. Этого будет достаточно для
  хранения всех архивов исходных кодов и компиляции пакетов. Однако, если планируется
  использовать LFS в качестве основной Linux системы, понадобится установка дополнительных
  пакетов, которые потребуют дополнительного места. Раздел 30 Гб будет разумным выбором на
  случай развития системы. Сама система LFS не займет столько места. Большая
  часть будет использована под временное хранилище, а также последующее
  расширение системы. Кроме того, компиляция пакетов требует много дополнительного
  места, которое будет освобождено после установки пакета.</para>

  <para>Так как оперативной памяти (RAM) не всегда может быть достаточно, рекомендуется
  использовать небольшой раздел подкачки <systemitem class="filesystem">swap</systemitem>.
  Он используется ядром для хранения редко используемых данных и оставляет больше памяти
  активным процессам. <systemitem class="filesystem">swap</systemitem> раздел LFS
  может общим с хост-системой. В этом случае создавать новый раздел необязательно.</para>

  <para>Запустите программу разметки диска, вроде <command>cfdisk</command>
  или <command>fdisk</command>, с указанием в командной строке имени диска, на котором
  будет создаваться раздел.
  Например, <filename class="devicefile">/dev/sda</filename> для основного жесткого диска.
  Создайте разделы с файловой системой Linux и, если нужно,
  <systemitem class="filesystem">swap</systemitem>. Прочитайте 
  <filename>cfdisk(8)</filename> или <filename>fdisk(8)</filename>, если вы еще не знаете, как
  использовать эти программы.</para>

  <note><para>Для опытных пользователей возможны другие схемы разбивки диска. LFS
  может быть установлен на <ulink
  url="&blfs-book;postlfs/raid.html">RAID</ulink> массив или на логический том <ulink
  url="&blfs-book;postlfs/aboutlvm.html">LVM</ulink>. Однако, некоторые из этих вариантов
  требуют пакет <ulink
  url="&blfs-book;postlfs/initramfs.html">initramfs</ulink>, который является более сложным
  материалом. Эти варианты разбивки не рекомендуются для новичков LFS.</para></note>

  <para>Запомните имя созданного раздела (например 
  <filename class="devicefile">sda5</filename>), книга будет ссылаться на него как на раздел
  LFS. Также запомните имя <systemitem class="filesystem">swap</systemitem> раздела,
  оно понадобятся позднее для файла <filename>/etc/fstab</filename>.</para>

  <sect2>
  <title>Другие вопросы по созданию разделов</title>

  <para>В списках рассылок LFS часто просят совета по созданию разделов. Это очень
  субъективная тема. Для большинства дистрибутивов создание раздела заключается
  в использовании всего диска, за исключением небольшого раздела подкачки. Такой подход
  неоптимален в случае LFS по нескольким причинам: уменьшение гибкости, усложнение 
  совместного использования данных несколькими дистрибутивами или сборками LFS, более
  длительный процесс резервного копирования, впустую потраченое дисковое пространство 
  вследствие неэффективного размещения структуры файловой системы.</para>

    <sect3>
    <title>Корневой раздел</title>

    <para>Корневой раздел LFS (не путать с каталогом 
    <filename class="directory">/root</filename>) размером в 20 Гб является хорошим
    выбором для большинства систем. Такого размера достаточно для сборки LFS и большинства
    пакетов BLFS, но сравнительно немного для создания нескольких разделов под 
    эксперименты.</para> </sect3>

    <sect3>
    <title>Раздел подкачки</title>

    <para>Многие дистрибутивы автоматически создают раздел подкачки. Обычно рекомендуемый
    размер - в два раза больше объема оперативной памяти, однако такая необходимость
    бывает редко. Если дисковое пространство ограничено, установите размер в 2
    гигабайта и отслеживайте размер свободного места в разделе подкачки.</para>

    <para>Если вы хотите использовать возможность гибернации Linux,
    которая перед выключением переносит все содержимое RAM на swap раздел, то
    размер swap должен быть не меньше размера установленной RAM.</para>

    <para>Использование swap это всегда нехорошо. При использовании механических дисков, 
    легко понять, что система начала использовать подкачку просто послушав активность
    обращения к диску и оценив скорость реакции на команды. При использовании SSD вы не
    сможете услышать обращение к подкачке, но сможете оценить её размер используя программы
    <command>top</command> или <command>free</command>. Использование подкачки следует 
    по возможности избегать. Первой реакцией на подкачку должна быть проверка на некорректную
    команду, такую как редактирование файла в пять гигабайт. Если подкачка становится
    привычным процессом, то лучшим решением будет покупка дополнительной оперативной памяти
    для вашей системы.</para></sect3>

    <sect3>
    <title>Радел Grub Bios</title>

    <para>Если <emphasis>загрузочный диск</emphasis> был размечен с помощью GUID Partition
    Table (GPT), то будет создан (если не был создан ранее) маленький, обычно около одного
    мегабайта, раздел. Этот неформатированный раздел будет использоваться GRUB для
    установки загрузчика. Он будет иметь метку 'BIOS Boot' при использовании утилиты
    <command>fdisk</command>, или иметь код <emphasis>EF02</emphasis> в случае
    использования <command>gdisk</command>.</para>

    <note><para>Раздел Grub Bios должен быть на диске, который BIOS использует для загрузки
    системы. Это не обязательно будет раздел на котором находится корневой раздел LFS. Диски
    в системе могут использовать различные таблицы разделов. Этот раздел требуется только для
    соответсвующего типа таблицы разметки загрузочного диска.</para></note>
    </sect3>

    <sect3>
    <title>Необязательные разделы</title>

    <para>Существует несколько других разделов, которые необязательны, но должны учитываться
    при проектировании разделов. Приведенный ниже перечень не является всеобъемлющим
    и представлен для краткого ознакомления.</para>

    <itemizedlist>

      <listitem><para>/boot &ndash; настоятельно рекомендуется. Используйте этот раздел
      для хранения ядра и прочей загрузочной информации. Для минимизации потенциальных
      проблем загрузки с больших дисков, сделайте его первым физическим разделом на
      жестком диске. Размер в 200 мегабайт будет предельно достаточен.</para></listitem>

      <listitem><para>/home &ndash; настоятельно рекомендуется. Используйте один домашний
      каталог для разных дистрибутивов или сборок LFS. Обычно размер его предельно большой
      и зависит от доступного места на диске.</para></listitem>

      <listitem><para>/usr &ndash; отдельный раздел /usr обычно используется для тонких
      клиентов и бездисковых рабочих станций. Обычно не требуется для LFS. Размер около 
      десяти гигабайт подойдёт для большинства установок.</para></listitem>

      <listitem><para>/opt &ndash; каталог в основном будет полезен для BLFS, где
      множество установок больших пакетов, таких как Gnome или KDE, может быть сделано не в
      каталог /usr. Размера от пяти до десяти гигабайт будет достаточен.</para>
      </listitem>

      <listitem><para>/tmp &ndash; отдельный каталог /tmp встречается редко, но будет полезен
      для тонких клиентов. Если этот раздел используется, то размер его обычно не превышает
      пары гигабайт.</para></listitem>

      <listitem><para>/usr/src &ndash; очень полезный раздел в качестве общего хранилища
      исходников BLFS для разных сборок LFS. Может также использоваться как место сборки
      пакетов BLFS. 30-50 гигабайт вполне достаточно. </para></listitem>

    </itemizedlist>

    <para>Любой раздел, который должен автоматически монтироваться при загрузке, нужно
    указать в файле <filename>/etc/fstab</filename>. Подробнее об этом написано в главе
    <xref linkend="ch-bootable-fstab"/>.</para>

    </sect3>
  </sect2>
</sect1>
